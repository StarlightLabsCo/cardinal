[1691127483770][33m[OPENAI] Creating chat completion...[39m
[1691127483771][33m[OPENAI] Creating embedding...[39m
[1691127483771][33m[OPENAI] Creating chat completion...[39m
[1691127483771][33m[OPENAI] Creating embedding...[39m
[1691127483771][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483772][33m[OPENAI] Creating embedding...[39m
[1691127483772][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483773][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483773][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483773][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483773][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483773][33m[OPENAI] Creating chat completion...[39m
[1691127483773][33m[OPENAI] Creating embedding...[39m
[1691127483903]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b5f8accefd-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "199",
    "x-ratelimit-remaining-tokens": "39912",
    "x-ratelimit-reset-requests": "300ms",
    "x-ratelimit-reset-tokens": "132ms",
    "x-request-id": "45676f665ac073f4c80a25b0284da810"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483904][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 3)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b5f8accefd-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '199',[39m
[31m    'x-ratelimit-remaining-tokens': '39912',[39m
[31m    'x-ratelimit-reset-requests': '300ms',[39m
[31m    'x-ratelimit-reset-tokens': '132ms',[39m
[31m    'x-request-id': '45676f665ac073f4c80a25b0284da810'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483905][31mFailed to create chat completion. Retrying...[39m
[1691127483909]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60e9815c6-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "193",
    "x-ratelimit-remaining-tokens": "39389",
    "x-ratelimit-reset-requests": "2.088s",
    "x-ratelimit-reset-tokens": "915ms",
    "x-request-id": "535453d5c9f2dd5842ae5dfdd3e80da6"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483910][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 5)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60e9815c6-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '193',[39m
[31m    'x-ratelimit-remaining-tokens': '39389',[39m
[31m    'x-ratelimit-reset-requests': '2.088s',[39m
[31m    'x-ratelimit-reset-tokens': '915ms',[39m
[31m    'x-request-id': '535453d5c9f2dd5842ae5dfdd3e80da6'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483910][31mFailed to create chat completion. Retrying...[39m
[1691127483932]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b5fc0d9444-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "198",
    "x-ratelimit-remaining-tokens": "39820",
    "x-ratelimit-reset-requests": "594ms",
    "x-ratelimit-reset-tokens": "268ms",
    "x-request-id": "1f586bf9acd014ce577072215149806c"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483932][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 12)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b5fc0d9444-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '198',[39m
[31m    'x-ratelimit-remaining-tokens': '39820',[39m
[31m    'x-ratelimit-reset-requests': '594ms',[39m
[31m    'x-ratelimit-reset-tokens': '268ms',[39m
[31m    'x-request-id': '1f586bf9acd014ce577072215149806c'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483932][31mFailed to create chat completion. Retrying...[39m
[1691127483937]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60c5596b4-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "194",
    "x-ratelimit-remaining-tokens": "39474",
    "x-ratelimit-reset-requests": "1.789s",
    "x-ratelimit-reset-tokens": "788ms",
    "x-request-id": "9505e62b12a77bdd53818c86425a0a4e"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483937][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 6)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60c5596b4-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '194',[39m
[31m    'x-ratelimit-remaining-tokens': '39474',[39m
[31m    'x-ratelimit-reset-requests': '1.789s',[39m
[31m    'x-ratelimit-reset-tokens': '788ms',[39m
[31m    'x-request-id': '9505e62b12a77bdd53818c86425a0a4e'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483938][31mFailed to create chat completion. Retrying...[39m
[1691127483940]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6083015df-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "197",
    "x-ratelimit-remaining-tokens": "39736",
    "x-ratelimit-reset-requests": "892ms",
    "x-ratelimit-reset-tokens": "395ms",
    "x-request-id": "b0876943c29eb365524339c023195f61"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483940][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 10)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6083015df-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '197',[39m
[31m    'x-ratelimit-remaining-tokens': '39736',[39m
[31m    'x-ratelimit-reset-requests': '892ms',[39m
[31m    'x-ratelimit-reset-tokens': '395ms',[39m
[31m    'x-request-id': 'b0876943c29eb365524339c023195f61'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483940][31mFailed to create chat completion. Retrying...[39m
[1691127483942]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60844ce4c-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "195",
    "x-ratelimit-remaining-tokens": "39558",
    "x-ratelimit-reset-requests": "1.49s",
    "x-ratelimit-reset-tokens": "662ms",
    "x-request-id": "9a291195e1958d54b38ae2c2dcc0a237"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483942][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 2)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60844ce4c-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '195',[39m
[31m    'x-ratelimit-remaining-tokens': '39558',[39m
[31m    'x-ratelimit-reset-requests': '1.49s',[39m
[31m    'x-ratelimit-reset-tokens': '662ms',[39m
[31m    'x-request-id': '9a291195e1958d54b38ae2c2dcc0a237'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483943][31mFailed to create chat completion. Retrying...[39m
[1691127483944]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b5fefa182a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "196",
    "x-ratelimit-remaining-tokens": "39647",
    "x-ratelimit-reset-requests": "1.191s",
    "x-ratelimit-reset-tokens": "528ms",
    "x-request-id": "b58ffe978200f4cb0bfe3603d9035c89"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483944][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 1)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b5fefa182a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '196',[39m
[31m    'x-ratelimit-remaining-tokens': '39647',[39m
[31m    'x-ratelimit-reset-requests': '1.191s',[39m
[31m    'x-ratelimit-reset-tokens': '528ms',[39m
[31m    'x-request-id': 'b58ffe978200f4cb0bfe3603d9035c89'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483944][31mFailed to create chat completion. Retrying...[39m
[1691127483946]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60cb51573-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "192",
    "x-ratelimit-remaining-tokens": "39303",
    "x-ratelimit-reset-requests": "2.385s",
    "x-ratelimit-reset-tokens": "1.044s",
    "x-request-id": "d064883c835a13a4878fadb1da1d4a53"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483947][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60cb51573-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '192',[39m
[31m    'x-ratelimit-remaining-tokens': '39303',[39m
[31m    'x-ratelimit-reset-requests': '2.385s',[39m
[31m    'x-ratelimit-reset-tokens': '1.044s',[39m
[31m    'x-request-id': 'd064883c835a13a4878fadb1da1d4a53'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483947][31mFailed to create chat completion. Retrying...[39m
[1691127483949]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60c2c9e5f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "190",
    "x-ratelimit-remaining-tokens": "39117",
    "x-ratelimit-reset-requests": "2.982s",
    "x-ratelimit-reset-tokens": "1.323s",
    "x-request-id": "6f62fce104fe7dd37576cc0f406f1ba0"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483950][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 9)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60c2c9e5f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '190',[39m
[31m    'x-ratelimit-remaining-tokens': '39117',[39m
[31m    'x-ratelimit-reset-requests': '2.982s',[39m
[31m    'x-ratelimit-reset-tokens': '1.323s',[39m
[31m    'x-request-id': '6f62fce104fe7dd37576cc0f406f1ba0'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483950][31mFailed to create chat completion. Retrying...[39m
[1691127483951]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b61d8a2548-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "189",
    "x-ratelimit-remaining-tokens": "39033",
    "x-ratelimit-reset-requests": "3.279s",
    "x-ratelimit-reset-tokens": "1.449s",
    "x-request-id": "179c6d7b71d42a4546f43378a548d978"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483951][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 8)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b61d8a2548-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '189',[39m
[31m    'x-ratelimit-remaining-tokens': '39033',[39m
[31m    'x-ratelimit-reset-requests': '3.279s',[39m
[31m    'x-ratelimit-reset-tokens': '1.449s',[39m
[31m    'x-request-id': '179c6d7b71d42a4546f43378a548d978'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483952][31mFailed to create chat completion. Retrying...[39m
[1691127483953]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b60ad6cf8f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "191",
    "x-ratelimit-remaining-tokens": "39204",
    "x-ratelimit-reset-requests": "2.682s",
    "x-ratelimit-reset-tokens": "1.193s",
    "x-request-id": "5cec9749d3bd63bb8d1990ba6a1c7937"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483953][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 13)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b60ad6cf8f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '191',[39m
[31m    'x-ratelimit-remaining-tokens': '39204',[39m
[31m    'x-ratelimit-reset-requests': '2.682s',[39m
[31m    'x-ratelimit-reset-tokens': '1.193s',[39m
[31m    'x-request-id': '5cec9749d3bd63bb8d1990ba6a1c7937'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483954][31mFailed to create chat completion. Retrying...[39m
[1691127483955]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6187fd03d-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "188",
    "x-ratelimit-remaining-tokens": "38948",
    "x-ratelimit-reset-requests": "3.576s",
    "x-ratelimit-reset-tokens": "1.577s",
    "x-request-id": "e113f4adb14831474132f28667502afd"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483955][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 7)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6187fd03d-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '188',[39m
[31m    'x-ratelimit-remaining-tokens': '38948',[39m
[31m    'x-ratelimit-reset-requests': '3.576s',[39m
[31m    'x-ratelimit-reset-tokens': '1.577s',[39m
[31m    'x-request-id': 'e113f4adb14831474132f28667502afd'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483955][31mFailed to create chat completion. Retrying...[39m
[1691127483957]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b61c28cec1-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "187",
    "x-ratelimit-remaining-tokens": "38858",
    "x-ratelimit-reset-requests": "3.876s",
    "x-ratelimit-reset-tokens": "1.711s",
    "x-request-id": "7fa7d7306f0f8c8a8c916efe9d1a622b"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483958][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 11)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b61c28cec1-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '187',[39m
[31m    'x-ratelimit-remaining-tokens': '38858',[39m
[31m    'x-ratelimit-reset-requests': '3.876s',[39m
[31m    'x-ratelimit-reset-tokens': '1.711s',[39m
[31m    'x-request-id': '7fa7d7306f0f8c8a8c916efe9d1a622b'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483958][31mFailed to create chat completion. Retrying...[39m
[1691127483960][32m[OPENAI] Embedding created successfully.[39m
[1691127483979]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6694fcefd-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "186",
    "x-ratelimit-remaining-tokens": "38808",
    "x-ratelimit-reset-requests": "4.119s",
    "x-ratelimit-reset-tokens": "1.786s",
    "x-request-id": "4289a87eedd2c8b422ca24d150ce6ff1"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127483980][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 3)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6694fcefd-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '186',[39m
[31m    'x-ratelimit-remaining-tokens': '38808',[39m
[31m    'x-ratelimit-reset-requests': '4.119s',[39m
[31m    'x-ratelimit-reset-tokens': '1.786s',[39m
[31m    'x-request-id': '4289a87eedd2c8b422ca24d150ce6ff1'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127483980][31mFailed to create chat completion. Retrying...[39m
[1691127483993][32m[OPENAI] Embedding created successfully.[39m
[1691127483998][32m[OPENAI] Embedding created successfully.[39m
[1691127484001]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b67ef515c6-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:03 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "185",
    "x-ratelimit-remaining-tokens": "38725",
    "x-ratelimit-reset-requests": "4.416s",
    "x-ratelimit-reset-tokens": "1.911s",
    "x-request-id": "17938955cd3d78546b9bb704dcece952"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484001][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 5)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b67ef515c6-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:03 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '185',[39m
[31m    'x-ratelimit-remaining-tokens': '38725',[39m
[31m    'x-ratelimit-reset-requests': '4.416s',[39m
[31m    'x-ratelimit-reset-tokens': '1.911s',[39m
[31m    'x-request-id': '17938955cd3d78546b9bb704dcece952'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484002][31mFailed to create chat completion. Retrying...[39m
[1691127484003][32m[OPENAI] Embedding created successfully.[39m
[1691127484004][32m[OPENAI] Embedding created successfully.[39m
[1691127484010][32m[OPENAI] Embedding created successfully.[39m
[1691127484011][32m[OPENAI] Embedding created successfully.[39m
[1691127484011][32m[OPENAI] Embedding created successfully.[39m
[1691127484012][32m[OPENAI] Embedding created successfully.[39m
[1691127484013][32m[OPENAI] Embedding created successfully.[39m
[1691127484033]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b69ca09444-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "183",
    "x-ratelimit-remaining-tokens": "38562",
    "x-ratelimit-reset-requests": "4.99s",
    "x-ratelimit-reset-tokens": "2.156s",
    "x-request-id": "95dd77032ff72e49eba725ead513c1bf"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484034][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 12)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b69ca09444-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '183',[39m
[31m    'x-ratelimit-remaining-tokens': '38562',[39m
[31m    'x-ratelimit-reset-requests': '4.99s',[39m
[31m    'x-ratelimit-reset-tokens': '2.156s',[39m
[31m    'x-request-id': '95dd77032ff72e49eba725ead513c1bf'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484034][31mFailed to create chat completion. Retrying...[39m
[1691127484036]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6be0b2548-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "178",
    "x-ratelimit-remaining-tokens": "38132",
    "x-ratelimit-reset-requests": "6.477s",
    "x-ratelimit-reset-tokens": "2.8s",
    "x-request-id": "afa0c8daf0b96312131fa7e4e3ef9411"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484036][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 8)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6be0b2548-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '178',[39m
[31m    'x-ratelimit-remaining-tokens': '38132',[39m
[31m    'x-ratelimit-reset-requests': '6.477s',[39m
[31m    'x-ratelimit-reset-tokens': '2.8s',[39m
[31m    'x-request-id': 'afa0c8daf0b96312131fa7e4e3ef9411'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484036][31mFailed to create chat completion. Retrying...[39m
[1691127484037]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6a8d715df-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "184",
    "x-ratelimit-remaining-tokens": "38657",
    "x-ratelimit-reset-requests": "4.69s",
    "x-ratelimit-reset-tokens": "2.014s",
    "x-request-id": "19766a8a64dee5066e9c563564a213be"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484038][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 10)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6a8d715df-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '184',[39m
[31m    'x-ratelimit-remaining-tokens': '38657',[39m
[31m    'x-ratelimit-reset-requests': '4.69s',[39m
[31m    'x-ratelimit-reset-tokens': '2.014s',[39m
[31m    'x-request-id': '19766a8a64dee5066e9c563564a213be'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484038][31mFailed to create chat completion. Retrying...[39m
[1691127484039]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6a8fece4c-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "182",
    "x-ratelimit-remaining-tokens": "38474",
    "x-ratelimit-reset-requests": "5.286s",
    "x-ratelimit-reset-tokens": "2.287s",
    "x-request-id": "bc75d11596e8e4eec623050d91a1b799"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484039][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 2)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6a8fece4c-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '182',[39m
[31m    'x-ratelimit-remaining-tokens': '38474',[39m
[31m    'x-ratelimit-reset-requests': '5.286s',[39m
[31m    'x-ratelimit-reset-tokens': '2.287s',[39m
[31m    'x-request-id': 'bc75d11596e8e4eec623050d91a1b799'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484040][31mFailed to create chat completion. Retrying...[39m
[1691127484041]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6c91ed03d-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "174",
    "x-ratelimit-remaining-tokens": "37775",
    "x-ratelimit-reset-requests": "7.672s",
    "x-ratelimit-reset-tokens": "3.337s",
    "x-request-id": "8133e479d08a55c403b9ffb32051c981"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484042][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 7)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6c91ed03d-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '174',[39m
[31m    'x-ratelimit-remaining-tokens': '37775',[39m
[31m    'x-ratelimit-reset-requests': '7.672s',[39m
[31m    'x-ratelimit-reset-tokens': '3.337s',[39m
[31m    'x-request-id': '8133e479d08a55c403b9ffb32051c981'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484042][31mFailed to create chat completion. Retrying...[39m
[1691127484044]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6bd4e1573-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "179",
    "x-ratelimit-remaining-tokens": "38216",
    "x-ratelimit-reset-requests": "6.18s",
    "x-ratelimit-reset-tokens": "2.675s",
    "x-request-id": "958dd88b62714a05db3d58ca7938fa45"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484044][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6bd4e1573-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '179',[39m
[31m    'x-ratelimit-remaining-tokens': '38216',[39m
[31m    'x-ratelimit-reset-requests': '6.18s',[39m
[31m    'x-ratelimit-reset-tokens': '2.675s',[39m
[31m    'x-request-id': '958dd88b62714a05db3d58ca7938fa45'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484044][31mFailed to create chat completion. Retrying...[39m
[1691127484045]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6bfa0182a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "180",
    "x-ratelimit-remaining-tokens": "38302",
    "x-ratelimit-reset-requests": "5.883s",
    "x-ratelimit-reset-tokens": "2.545s",
    "x-request-id": "c63872e8890cbc236f872e1eb31ccc5d"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484046][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 1)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6bfa0182a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '180',[39m
[31m    'x-ratelimit-remaining-tokens': '38302',[39m
[31m    'x-ratelimit-reset-requests': '5.883s',[39m
[31m    'x-ratelimit-reset-tokens': '2.545s',[39m
[31m    'x-request-id': 'c63872e8890cbc236f872e1eb31ccc5d'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484046][31mFailed to create chat completion. Retrying...[39m
[1691127484047]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6bba2cf8f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "176",
    "x-ratelimit-remaining-tokens": "37948",
    "x-ratelimit-reset-requests": "7.073s",
    "x-ratelimit-reset-tokens": "3.077s",
    "x-request-id": "ac9561610affa388a594777bdd061172"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484047][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 13)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6bba2cf8f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '176',[39m
[31m    'x-ratelimit-remaining-tokens': '37948',[39m
[31m    'x-ratelimit-reset-requests': '7.073s',[39m
[31m    'x-ratelimit-reset-tokens': '3.077s',[39m
[31m    'x-request-id': 'ac9561610affa388a594777bdd061172'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484047][31mFailed to create chat completion. Retrying...[39m
[1691127484048]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6acdf96b4-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "181",
    "x-ratelimit-remaining-tokens": "38389",
    "x-ratelimit-reset-requests": "5.586s",
    "x-ratelimit-reset-tokens": "2.415s",
    "x-request-id": "213bbe5abe5c451325cc6fd8e5866c4f"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484048][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 6)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6acdf96b4-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '181',[39m
[31m    'x-ratelimit-remaining-tokens': '38389',[39m
[31m    'x-ratelimit-reset-requests': '5.586s',[39m
[31m    'x-ratelimit-reset-tokens': '2.415s',[39m
[31m    'x-request-id': '213bbe5abe5c451325cc6fd8e5866c4f'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484049][31mFailed to create chat completion. Retrying...[39m
[1691127484050]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6e9d6cefd-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "172",
    "x-ratelimit-remaining-tokens": "37612",
    "x-ratelimit-reset-requests": "8.248s",
    "x-ratelimit-reset-tokens": "3.58s",
    "x-request-id": "3d2c6dff4ed3af0b9308ab98608176ff"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484050][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 3)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6e9d6cefd-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '172',[39m
[31m    'x-ratelimit-remaining-tokens': '37612',[39m
[31m    'x-ratelimit-reset-requests': '8.248s',[39m
[31m    'x-ratelimit-reset-tokens': '3.58s',[39m
[31m    'x-request-id': '3d2c6dff4ed3af0b9308ab98608176ff'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484050][31mFailed to create chat completion. Retrying...[39m
[1691127484051][32m[OPENAI] Embedding created successfully.[39m
[1691127484051][32m[OPENAI] Embedding created successfully.[39m
[1691127484051]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6bcf59e5f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "175",
    "x-ratelimit-remaining-tokens": "37861",
    "x-ratelimit-reset-requests": "7.373s",
    "x-ratelimit-reset-tokens": "3.207s",
    "x-request-id": "9dc34bdd2a43e4c1f39627bdaf1db639"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484052][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 9)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6bcf59e5f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '175',[39m
[31m    'x-ratelimit-remaining-tokens': '37861',[39m
[31m    'x-ratelimit-reset-requests': '7.373s',[39m
[31m    'x-ratelimit-reset-tokens': '3.207s',[39m
[31m    'x-request-id': '9dc34bdd2a43e4c1f39627bdaf1db639'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484052][31mFailed to create chat completion. Retrying...[39m
[1691127484053]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b5f863176a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "177",
    "x-ratelimit-remaining-tokens": "38047",
    "x-ratelimit-reset-requests": "6.775s",
    "x-ratelimit-reset-tokens": "2.928s",
    "x-request-id": "315c467e5c125601cc2d32d102c94ec0"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484054][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 4)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b5f863176a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '177',[39m
[31m    'x-ratelimit-remaining-tokens': '38047',[39m
[31m    'x-ratelimit-reset-requests': '6.775s',[39m
[31m    'x-ratelimit-reset-tokens': '2.928s',[39m
[31m    'x-request-id': '315c467e5c125601cc2d32d102c94ec0'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484054][31mFailed to create chat completion. Retrying...[39m
[1691127484055][32m[OPENAI] Embedding created successfully.[39m
[1691127484098]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b6cce8cec1-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "173",
    "x-ratelimit-remaining-tokens": "37697",
    "x-ratelimit-reset-requests": "7.953s",
    "x-ratelimit-reset-tokens": "3.453s",
    "x-request-id": "e6004614259260d631f51a72c6d3ae6e"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484099][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 11)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b6cce8cec1-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '173',[39m
[31m    'x-ratelimit-remaining-tokens': '37697',[39m
[31m    'x-ratelimit-reset-requests': '7.953s',[39m
[31m    'x-ratelimit-reset-tokens': '3.453s',[39m
[31m    'x-request-id': 'e6004614259260d631f51a72c6d3ae6e'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484099][31mFailed to create chat completion. Retrying...[39m
[1691127484100]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b70f9b15c6-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "171",
    "x-ratelimit-remaining-tokens": "37542",
    "x-ratelimit-reset-requests": "8.526s",
    "x-ratelimit-reset-tokens": "3.686s",
    "x-request-id": "4dda6863391ecc340dd4d729cdd55286"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484100][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 5)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b70f9b15c6-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '171',[39m
[31m    'x-ratelimit-remaining-tokens': '37542',[39m
[31m    'x-ratelimit-reset-requests': '8.526s',[39m
[31m    'x-ratelimit-reset-tokens': '3.686s',[39m
[31m    'x-request-id': '4dda6863391ecc340dd4d729cdd55286'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484100][31mFailed to create chat completion. Retrying...[39m
[1691127484113]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7495f15df-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "167",
    "x-ratelimit-remaining-tokens": "37210",
    "x-ratelimit-reset-requests": "9.689s",
    "x-ratelimit-reset-tokens": "4.184s",
    "x-request-id": "872d1284eea18c531ae2b2a78d279709"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484113][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 10)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7495f15df-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '167',[39m
[31m    'x-ratelimit-remaining-tokens': '37210',[39m
[31m    'x-ratelimit-reset-requests': '9.689s',[39m
[31m    'x-ratelimit-reset-tokens': '4.184s',[39m
[31m    'x-request-id': '872d1284eea18c531ae2b2a78d279709'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484113][31mFailed to create chat completion. Retrying...[39m
[1691127484116]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7498bd03d-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "165",
    "x-ratelimit-remaining-tokens": "37026",
    "x-ratelimit-reset-requests": "10.283s",
    "x-ratelimit-reset-tokens": "4.46s",
    "x-request-id": "b1595acffe883cd31ea0c93f969691b5"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484116][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 7)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7498bd03d-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '165',[39m
[31m    'x-ratelimit-remaining-tokens': '37026',[39m
[31m    'x-ratelimit-reset-requests': '10.283s',[39m
[31m    'x-ratelimit-reset-tokens': '4.46s',[39m
[31m    'x-request-id': 'b1595acffe883cd31ea0c93f969691b5'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484116][31mFailed to create chat completion. Retrying...[39m
[1691127484124]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b749bdce4c-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "168",
    "x-ratelimit-remaining-tokens": "37294",
    "x-ratelimit-reset-requests": "9.392s",
    "x-ratelimit-reset-tokens": "4.058s",
    "x-request-id": "f633d9d7985d7d650ebe501b8a3798da"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484125][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 2)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b749bdce4c-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '168',[39m
[31m    'x-ratelimit-remaining-tokens': '37294',[39m
[31m    'x-ratelimit-reset-requests': '9.392s',[39m
[31m    'x-ratelimit-reset-tokens': '4.058s',[39m
[31m    'x-request-id': 'f633d9d7985d7d650ebe501b8a3798da'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484125][31mFailed to create chat completion. Retrying...[39m
[1691127484126]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7585c182a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "160",
    "x-ratelimit-remaining-tokens": "36597",
    "x-ratelimit-reset-requests": "11.77s",
    "x-ratelimit-reset-tokens": "5.103s",
    "x-request-id": "a8a07e7fc9e4eaae222f5323bdad36cf"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484126][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 1)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7585c182a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '160',[39m
[31m    'x-ratelimit-remaining-tokens': '36597',[39m
[31m    'x-ratelimit-reset-requests': '11.77s',[39m
[31m    'x-ratelimit-reset-tokens': '5.103s',[39m
[31m    'x-request-id': 'a8a07e7fc9e4eaae222f5323bdad36cf'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484127][31mFailed to create chat completion. Retrying...[39m
[1691127484144]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75db89e5f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "161",
    "x-ratelimit-remaining-tokens": "36684",
    "x-ratelimit-reset-requests": "11.474s",
    "x-ratelimit-reset-tokens": "4.973s",
    "x-request-id": "b64d35af5c91f2e7a4cd70acf84c2462"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484144][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 9)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75db89e5f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '161',[39m
[31m    'x-ratelimit-remaining-tokens': '36684',[39m
[31m    'x-ratelimit-reset-requests': '11.474s',[39m
[31m    'x-ratelimit-reset-tokens': '4.973s',[39m
[31m    'x-request-id': 'b64d35af5c91f2e7a4cd70acf84c2462'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484144][31mFailed to create chat completion. Retrying...[39m
[1691127484146]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b74e6c2548-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "169",
    "x-ratelimit-remaining-tokens": "37384",
    "x-ratelimit-reset-requests": "9.092s",
    "x-ratelimit-reset-tokens": "3.923s",
    "x-request-id": "e457acc2990b691d5eb2fe2414c97278"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484146][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 8)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b74e6c2548-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '169',[39m
[31m    'x-ratelimit-remaining-tokens': '37384',[39m
[31m    'x-ratelimit-reset-requests': '9.092s',[39m
[31m    'x-ratelimit-reset-tokens': '3.923s',[39m
[31m    'x-request-id': 'e457acc2990b691d5eb2fe2414c97278'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484146][31mFailed to create chat completion. Retrying...[39m
[1691127484148]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75c45cf8f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "166",
    "x-ratelimit-remaining-tokens": "37112",
    "x-ratelimit-reset-requests": "9.984s",
    "x-ratelimit-reset-tokens": "4.331s",
    "x-request-id": "c3bed44940e4f96fa53f7fd41549a39f"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484148][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 13)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75c45cf8f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '166',[39m
[31m    'x-ratelimit-remaining-tokens': '37112',[39m
[31m    'x-ratelimit-reset-requests': '9.984s',[39m
[31m    'x-ratelimit-reset-tokens': '4.331s',[39m
[31m    'x-request-id': 'c3bed44940e4f96fa53f7fd41549a39f'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484149][31mFailed to create chat completion. Retrying...[39m
[1691127484150]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75d4d96b4-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "163",
    "x-ratelimit-remaining-tokens": "36855",
    "x-ratelimit-reset-requests": "10.879s",
    "x-ratelimit-reset-tokens": "4.716s",
    "x-request-id": "3432439ef4e4bd4580f3363d44984862"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484151][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 6)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75d4d96b4-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '163',[39m
[31m    'x-ratelimit-remaining-tokens': '36855',[39m
[31m    'x-ratelimit-reset-requests': '10.879s',[39m
[31m    'x-ratelimit-reset-tokens': '4.716s',[39m
[31m    'x-request-id': '3432439ef4e4bd4580f3363d44984862'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484151][31mFailed to create chat completion. Retrying...[39m
[1691127484153]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75a51cefd-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "164",
    "x-ratelimit-remaining-tokens": "36940",
    "x-ratelimit-reset-requests": "10.58s",
    "x-ratelimit-reset-tokens": "4.589s",
    "x-request-id": "869ffe06f3a4d67fd7c40fca9f6c8dad"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484153][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 3)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75a51cefd-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '164',[39m
[31m    'x-ratelimit-remaining-tokens': '36940',[39m
[31m    'x-ratelimit-reset-requests': '10.58s',[39m
[31m    'x-ratelimit-reset-tokens': '4.589s',[39m
[31m    'x-request-id': '869ffe06f3a4d67fd7c40fca9f6c8dad'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484153][31mFailed to create chat completion. Retrying...[39m
[1691127484154]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75e1c1573-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "162",
    "x-ratelimit-remaining-tokens": "36768",
    "x-ratelimit-reset-requests": "11.179s",
    "x-ratelimit-reset-tokens": "4.847s",
    "x-request-id": "a43a1272ba9a06105202a16606cea48f"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484155][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75e1c1573-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '162',[39m
[31m    'x-ratelimit-remaining-tokens': '36768',[39m
[31m    'x-ratelimit-reset-requests': '11.179s',[39m
[31m    'x-ratelimit-reset-tokens': '4.847s',[39m
[31m    'x-request-id': 'a43a1272ba9a06105202a16606cea48f'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484155][31mFailed to create chat completion. Retrying...[39m
[1691127484162]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b75a26176a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "159",
    "x-ratelimit-remaining-tokens": "36511",
    "x-ratelimit-reset-requests": "12.071s",
    "x-ratelimit-reset-tokens": "5.232s",
    "x-request-id": "5a2d5c81dc9788a93957aec446a7e20c"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484163][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 4)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b75a26176a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '159',[39m
[31m    'x-ratelimit-remaining-tokens': '36511',[39m
[31m    'x-ratelimit-reset-requests': '12.071s',[39m
[31m    'x-ratelimit-reset-tokens': '5.232s',[39m
[31m    'x-request-id': '5a2d5c81dc9788a93957aec446a7e20c'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484163][31mFailed to create chat completion. Retrying...[39m
[1691127484200]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7ca29d03d-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "155",
    "x-ratelimit-remaining-tokens": "36205",
    "x-ratelimit-reset-requests": "13.208s",
    "x-ratelimit-reset-tokens": "5.692s",
    "x-request-id": "6b48e1ab224de555308c2739ce32c712"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484201][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 7)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7ca29d03d-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '155',[39m
[31m    'x-ratelimit-remaining-tokens': '36205',[39m
[31m    'x-ratelimit-reset-requests': '13.208s',[39m
[31m    'x-ratelimit-reset-tokens': '5.692s',[39m
[31m    'x-request-id': '6b48e1ab224de555308c2739ce32c712'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484202][31mFailed to create chat completion. Retrying...[39m
[1691127484204]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7caa4ce4c-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "154",
    "x-ratelimit-remaining-tokens": "36120",
    "x-ratelimit-reset-requests": "13.5s",
    "x-ratelimit-reset-tokens": "5.818s",
    "x-request-id": "3444a72138427c8d19508e6550f4c163"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484204][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 2)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7caa4ce4c-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '154',[39m
[31m    'x-ratelimit-remaining-tokens': '36120',[39m
[31m    'x-ratelimit-reset-requests': '13.5s',[39m
[31m    'x-ratelimit-reset-tokens': '5.818s',[39m
[31m    'x-request-id': '3444a72138427c8d19508e6550f4c163'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484204][31mFailed to create chat completion. Retrying...[39m
[1691127484207]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7a82115c6-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "157",
    "x-ratelimit-remaining-tokens": "36368",
    "x-ratelimit-reset-requests": "12.622s",
    "x-ratelimit-reset-tokens": "5.446s",
    "x-request-id": "f16c92dae26cc4ab89f340bc26c3e4b3"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484208][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 5)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7a82115c6-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '157',[39m
[31m    'x-ratelimit-remaining-tokens': '36368',[39m
[31m    'x-ratelimit-reset-requests': '12.622s',[39m
[31m    'x-ratelimit-reset-tokens': '5.446s',[39m
[31m    'x-request-id': 'f16c92dae26cc4ab89f340bc26c3e4b3'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484208][31mFailed to create chat completion. Retrying...[39m
[1691127484209]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7adb1cec1-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "6",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "158",
    "x-ratelimit-remaining-tokens": "36452",
    "x-ratelimit-reset-requests": "12.325s",
    "x-ratelimit-reset-tokens": "5.321s",
    "x-request-id": "468eb05979e9d453c08ff31947dee706"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484209][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 11)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7adb1cec1-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '6',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '158',[39m
[31m    'x-ratelimit-remaining-tokens': '36452',[39m
[31m    'x-ratelimit-reset-requests': '12.325s',[39m
[31m    'x-ratelimit-reset-tokens': '5.321s',[39m
[31m    'x-request-id': '468eb05979e9d453c08ff31947dee706'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484209][31mFailed to create chat completion. Retrying...[39m
[1691127484213]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7b9d915df-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "156",
    "x-ratelimit-remaining-tokens": "36285",
    "x-ratelimit-reset-requests": "12.918s",
    "x-ratelimit-reset-tokens": "5.571s",
    "x-request-id": "5f5c005f374537abc830e4fa532183d9"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484214][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 10)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7b9d915df-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '156',[39m
[31m    'x-ratelimit-remaining-tokens': '36285',[39m
[31m    'x-ratelimit-reset-requests': '12.918s',[39m
[31m    'x-ratelimit-reset-tokens': '5.571s',[39m
[31m    'x-request-id': '5f5c005f374537abc830e4fa532183d9'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484214][31mFailed to create chat completion. Retrying...[39m
[1691127484235]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7fe499e5f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "151",
    "x-ratelimit-remaining-tokens": "35770",
    "x-ratelimit-reset-requests": "14.681s",
    "x-ratelimit-reset-tokens": "6.344s",
    "x-request-id": "f7e40f8d69789157a9aa151cd44a8e21"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484236][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 9)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7fe499e5f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '151',[39m
[31m    'x-ratelimit-remaining-tokens': '35770',[39m
[31m    'x-ratelimit-reset-requests': '14.681s',[39m
[31m    'x-ratelimit-reset-tokens': '6.344s',[39m
[31m    'x-request-id': 'f7e40f8d69789157a9aa151cd44a8e21'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484236][31mFailed to create chat completion. Retrying...[39m
[1691127484245]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b80ed91573-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "149",
    "x-ratelimit-remaining-tokens": "35600",
    "x-ratelimit-reset-requests": "15.272s",
    "x-ratelimit-reset-tokens": "6.599s",
    "x-request-id": "9e372a74ba0577cd71e7f3f65b06363f"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484246][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b80ed91573-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '149',[39m
[31m    'x-ratelimit-remaining-tokens': '35600',[39m
[31m    'x-ratelimit-reset-requests': '15.272s',[39m
[31m    'x-ratelimit-reset-tokens': '6.599s',[39m
[31m    'x-request-id': '9e372a74ba0577cd71e7f3f65b06363f'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484247][31mFailed to create chat completion. Retrying...[39m
[1691127484248]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7d96b182a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "154",
    "x-ratelimit-remaining-tokens": "36033",
    "x-ratelimit-reset-requests": "13.797s",
    "x-ratelimit-reset-tokens": "5.949s",
    "x-request-id": "4b8c157908769b496a8cdb7488234da0"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484249][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 1)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7d96b182a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '154',[39m
[31m    'x-ratelimit-remaining-tokens': '36033',[39m
[31m    'x-ratelimit-reset-requests': '13.797s',[39m
[31m    'x-ratelimit-reset-tokens': '5.949s',[39m
[31m    'x-request-id': '4b8c157908769b496a8cdb7488234da0'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484249][31mFailed to create chat completion. Retrying...[39m
[1691127484251]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7fb55cefd-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "150",
    "x-ratelimit-remaining-tokens": "35684",
    "x-ratelimit-reset-requests": "14.977s",
    "x-ratelimit-reset-tokens": "6.472s",
    "x-request-id": "5736d6634ba4d23b06f2c35aab6582c5"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484252][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 3)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7fb55cefd-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '150',[39m
[31m    'x-ratelimit-remaining-tokens': '35684',[39m
[31m    'x-ratelimit-reset-requests': '14.977s',[39m
[31m    'x-ratelimit-reset-tokens': '6.472s',[39m
[31m    'x-request-id': '5736d6634ba4d23b06f2c35aab6582c5'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484252][31mFailed to create chat completion. Retrying...[39m
[1691127484256]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7fd09cf8f-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "152",
    "x-ratelimit-remaining-tokens": "35857",
    "x-ratelimit-reset-requests": "14.381s",
    "x-ratelimit-reset-tokens": "6.214s",
    "x-request-id": "f38613bd6fec08a537b86c26c0cee0d4"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484256][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 13)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7fd09cf8f-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '152',[39m
[31m    'x-ratelimit-remaining-tokens': '35857',[39m
[31m    'x-ratelimit-reset-requests': '14.381s',[39m
[31m    'x-ratelimit-reset-tokens': '6.214s',[39m
[31m    'x-request-id': 'f38613bd6fec08a537b86c26c0cee0d4'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484256][31mFailed to create chat completion. Retrying...[39m
[1691127484257]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7fef02548-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "153",
    "x-ratelimit-remaining-tokens": "35958",
    "x-ratelimit-reset-requests": "14.081s",
    "x-ratelimit-reset-tokens": "6.062s",
    "x-request-id": "5c8942f4705e68b5b3a1fe28e34ee05a"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484258][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 8)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7fef02548-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '153',[39m
[31m    'x-ratelimit-remaining-tokens': '35958',[39m
[31m    'x-ratelimit-reset-requests': '14.081s',[39m
[31m    'x-ratelimit-reset-tokens': '6.062s',[39m
[31m    'x-request-id': '5c8942f4705e68b5b3a1fe28e34ee05a'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484261][31mFailed to create chat completion. Retrying...[39m
[1691127484262]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b80ae1176a-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "5",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "147",
    "x-ratelimit-remaining-tokens": "35434",
    "x-ratelimit-reset-requests": "15.865s",
    "x-ratelimit-reset-tokens": "6.848s",
    "x-request-id": "79e67a2867487662ea50660fce94ae64"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484263][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 4)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b80ae1176a-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '5',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '147',[39m
[31m    'x-ratelimit-remaining-tokens': '35434',[39m
[31m    'x-ratelimit-reset-requests': '15.865s',[39m
[31m    'x-ratelimit-reset-tokens': '6.848s',[39m
[31m    'x-request-id': '79e67a2867487662ea50660fce94ae64'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484263][31mFailed to create chat completion. Retrying...[39m
[1691127484265]{
  "status": 400,
  "headers": {
    "access-control-allow-origin": "*",
    "alt-svc": "h3=\":443\"; ma=86400",
    "cf-cache-status": "DYNAMIC",
    "cf-ray": "7f1473b7fdcc96b4-SJC",
    "connection": "keep-alive",
    "content-length": "222",
    "content-type": "application/json",
    "date": "Fri, 04 Aug 2023 05:38:04 GMT",
    "openai-organization": "ember-ai",
    "openai-processing-ms": "4",
    "openai-version": "2020-10-01",
    "server": "cloudflare",
    "strict-transport-security": "max-age=15724800; includeSubDomains",
    "x-ratelimit-limit-requests": "200",
    "x-ratelimit-limit-tokens": "40000",
    "x-ratelimit-remaining-requests": "148",
    "x-ratelimit-remaining-tokens": "35515",
    "x-ratelimit-reset-requests": "15.572s",
    "x-ratelimit-reset-tokens": "6.726s",
    "x-request-id": "9ca11107e1e2df384748ad6d780e78b9"
  },
  "error": {
    "message": "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",
    "type": "invalid_request_error",
    "param": "function_call",
    "code": null
  },
  "code": null,
  "param": "function_call",
  "type": "invalid_request_error"
}
[1691127484266][31mBadRequestError: Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.[39m
[31m    at APIError.generate (file:///Users/harris/src/starlightshire-server/node_modules/openai/error.mjs:31:14)[39m
[31m    at OpenAI.makeStatusError (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:176:21)[39m
[31m    at OpenAI.request (file:///Users/harris/src/starlightshire-server/node_modules/openai/core.mjs:212:24)[39m
[31m    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m    at async createChatCompletion (file:///Users/harris/src/starlightshire-server/dist/src/ai/openai.js:46:30)[39m
[31m    at async getMemoryImportance (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:13:24)[39m
[31m    at async Promise.all (index 0)[39m
[31m    at async createMemory (file:///Users/harris/src/starlightshire-server/dist/src/ai/memory.js:48:37)[39m
[31m    at async Promise.all (index 6)[39m
[31m    at async createThomas (file:///Users/harris/src/starlightshire-server/dist/src/character.js:41:5) {[39m
[31m  status: 400,[39m
[31m  headers: {[39m
[31m    'access-control-allow-origin': '*',[39m
[31m    'alt-svc': 'h3=":443"; ma=86400',[39m
[31m    'cf-cache-status': 'DYNAMIC',[39m
[31m    'cf-ray': '7f1473b7fdcc96b4-SJC',[39m
[31m    connection: 'keep-alive',[39m
[31m    'content-length': '222',[39m
[31m    'content-type': 'application/json',[39m
[31m    date: 'Fri, 04 Aug 2023 05:38:04 GMT',[39m
[31m    'openai-organization': 'ember-ai',[39m
[31m    'openai-processing-ms': '4',[39m
[31m    'openai-version': '2020-10-01',[39m
[31m    server: 'cloudflare',[39m
[31m    'strict-transport-security': 'max-age=15724800; includeSubDomains',[39m
[31m    'x-ratelimit-limit-requests': '200',[39m
[31m    'x-ratelimit-limit-tokens': '40000',[39m
[31m    'x-ratelimit-remaining-requests': '148',[39m
[31m    'x-ratelimit-remaining-tokens': '35515',[39m
[31m    'x-ratelimit-reset-requests': '15.572s',[39m
[31m    'x-ratelimit-reset-tokens': '6.726s',[39m
[31m    'x-request-id': '9ca11107e1e2df384748ad6d780e78b9'[39m
[31m  },[39m
[31m  error: {[39m
[31m    message: "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.",[39m
[31m    type: 'invalid_request_error',[39m
[31m    param: 'function_call',[39m
[31m    code: null[39m
[31m  },[39m
[31m  code: null,[39m
[31m  param: 'function_call',[39m
[31m  type: 'invalid_request_error'[39m
[31m}[39m
[1691127484266][31mFailed to create chat completion. Retrying...[39m
